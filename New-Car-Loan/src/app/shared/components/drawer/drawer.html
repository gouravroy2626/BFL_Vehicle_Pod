@if (isOpen) {
<div class="drawer-backdrop" (click)="onBackdropClick()"></div>
<div class="drawer" [class.expanded]="isContentVisible" [class.has-error]="showError && !selectedOption"
  *ngIf="screenMap['select-an-option'] as selectOption">
  @let fields = selectOption?.fields ?? [];
  <!-- Row 1: Close button -->
  <div class="drawer-row-1">
    <span class="close-button" (click)="onCloseClick()">&times;</span>
  </div>

  <!-- Row 2: Title -->
  <div class="drawer-row-2">
    <p class="drawer-title">

  {{ selectOption?.['form-heading'] }}

    </p>
  </div>

  <!-- Row 3: Auto-fill details -->
  <div class="drawer-row-3" [class.selected]="selectedOption === 'auto'">
    <div class="row3-layout">
      <!-- Column 1: Radio button -->
      <div class="radio-column">
        <input type="radio" name="fillOption" value="auto" [checked]="selectedOption === 'auto'"
          (change)="onOptionChange('auto')" class="radio-input">
      </div>

      <!-- Column 2: Content -->
      <div class="content-column">
        <!-- First line: Label and badge -->
        <div class="label-row">
          <span class="label-text">

            {{ fields?.[0]?.['field-label-main'] }}

          </span>
          <span class="faster-badge">
            <img src="/Rectangle 33091.svg" alt="Faster badge" width="9" height="12">
            Faster
          </span>
        </div>

        <!-- Description text -->
        <p class="description-text">

          {{ fields?.[0]?.['field-description'] }}

        </p>

        <!-- Full Name field (only when auto is selected) -->
        @if (selectedOption === 'auto') {
        <div class="full-name-section">
          <label class="full-name-label">

            {{ fields?.[1]?.['title'] }}

            <span class="required">*</span></label>
          <input type="text" class="full-name-input" style="padding-left: 15px; padding-top: 10px;"
            placeholder="Enter full name as per PAN card" [(ngModel)]="fullName" (input)="onFullNameInput($event)"
            pattern="[A-Za-z ]+" [class.highlight-autofill]="fullNameHighlight">
          @if (showNameError) {
          <div class="name-error-message">
            <img src="/Frame 1707485144.svg" alt="Error" width="14" height="14">
            <span>Please enter your full name</span>
          </div>
          }
        </div>
        }
        <!-- Show More button -->
        @if (!isContentVisible) {
        <button class="show-more-btn" (click)="onToggleText()">

          {{ fields?.[4]?.['ctalabel1'] }} 
          
          <svg class="arrow-down" width="14" height="14" viewBox="0 0 14 14"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 5L7 10L12 5" stroke="#FF6600" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
        }

        <!-- Expanded content -->
        @if (isContentVisible) {
        <div class="expanded-content">
          <div class="info-section">
            <p class="info-title"> 
              
              {{ fields?.[2]?.['title'] }} 
            
            </p>
            <p class="info-text">
              {{ fields?.[2]?.['description'] }}
            </p>
          </div>

          <div class="security-box">
            <img [src]="fields?.[3]?.['iconimage-android']" alt="Logo" class="brand-logo">
            <p class="security-text">

              {{ fields?.[3]?.['icontitle'] }}

            </p>
          </div>

          <button class="show-more-btn" (click)="onToggleText()">

            {{ fields?.[4]?.['ctalabel2'] }}
            
            <svg class="arrow-down arrow-up" width="14" height="14" viewBox="0 0 14 14" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path d="M12 9L7 4L2 9" stroke="#FF6600" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </button>
        </div>
        }
      </div>
    </div>
  </div>

  <!-- Row 4: Manual option -->
  <div class="drawer-row-4" [class.selected]="selectedOption === 'manual'">
    <label class="radio-label">
      <input type="radio" name="fillOption" value="manual" [checked]="selectedOption === 'manual'"
        (change)="onOptionChange('manual')" class="radio-input">
  <span class="label-text">{{ fields?.[5]?.['title'] ?? 'Fill details manually' }}</span>
    </label>
  </div>

  <!-- Error message -->
  @if (showError && !selectedOption) {
  <div class="error-message">
    <img src="/Frame 1707485144.svg" alt="Error icon" class="error-icon" width="16" height="16">
    <span>Please select an option to continue</span>
  </div>
  }

  <!-- Row 5: Continue button -->
  <div class="drawer-row-5">
    <button class="btn-continue" (click)="onContinueClick()">
  {{ screenMap['continue-button']?.['ctalabel1'] ?? 'CONTINUE' }}
    </button>
  </div>
</div>
}